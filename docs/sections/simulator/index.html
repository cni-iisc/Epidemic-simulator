

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The simulator &mdash; IISc-TIFR City-Scale Agent Based Simulator 0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../assets/css/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Simulator parameters" href="parameter.html" />
    <link rel="prev" title="Generating synthetic city" href="../instantiation/create_synthetic_city.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> IISc-TIFR City-Scale Agent Based Simulator
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start.html">Quick start guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../instantiation/index.html">Instantiating a synthetic city</a></li>
<li class="toctree-l1"><a class="reference internal" href="../instantiation/setting_up_py_env.html">Setting up the python environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../instantiation/prepare_data.html">Preparing the data to instantiate</a></li>
<li class="toctree-l1"><a class="reference internal" href="../instantiation/create_synthetic_city.html">Generating synthetic city</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter.html">Simulator parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="interventions.html">Interventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="attendance.html">Workplace attendance</a></li>
<li class="toctree-l1"><a class="reference internal" href="load_store.html">Load – Store feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="web_app.html">Javascript simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../calibrate.html">Calibrating the simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../copyright.html">License and Copyrights</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">IISc-TIFR City-Scale Agent Based Simulator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>The simulator</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/sections/simulator/index.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-simulator">
<h1>The simulator<a class="headerlink" href="#the-simulator" title="Permalink to this headline">¶</a></h1>
<p>You can now compile the code in the <code class="docutils literal notranslate"><span class="pre">cpp_simulator</span></code> directory by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make all
</pre></div>
</div>
<p>However, if you do not want to use, or do not have, the <code class="docutils literal notranslate"><span class="pre">openmp</span></code>
parallel libraries, you should instead run</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make -f Makefile_np all
</pre></div>
</div>
<p>By default, the load–store feature is disabled in the simulator, for backward compatibility. To use this feature, use the following command in <code class="docutils literal notranslate"><span class="pre">make</span></code>.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">openmp</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">enable_proto</span><span class="o">=</span>yes all
</pre></div>
</div>
<p>Without <code class="docutils literal notranslate"><span class="pre">openmp</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>make <span class="nv">enable_proto</span><span class="o">=</span>yes -f Makefile_np all
</pre></div>
</div>
<p>This will generate an executable file called <code class="docutils literal notranslate"><span class="pre">drive_simulator</span></code> in the
same directory.  This is the simulator program.</p>
<div class="section" id="running-the-code">
<h2>Running the code<a class="headerlink" href="#running-the-code" title="Permalink to this headline">¶</a></h2>
<p>Please proceed with this step only after compiling the code, as described in the
previous step.</p>
<p>There are two ways to run the simulator.  However, before running it, you will
need to generate the input files for the simulator (corresponding to the city
you want to simulate).  Instructions for doing this are in the <a class="reference internal" href="../instantiation/create_synthetic_city.html"><span class="doc">Generating synthetic city</span></a> page.</p>
<div class="section" id="method-1-running-drive-simulator-directly">
<h3>Method 1: Running <code class="docutils literal notranslate"><span class="pre">drive_simulator</span></code> directly<a class="headerlink" href="#method-1-running-drive-simulator-directly" title="Permalink to this headline">¶</a></h3>
<p>For this, first run the following command</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./drive_simulator -h
</pre></div>
</div>
<p>and examine the various options available.  In particular, you need to specify
the <code class="docutils literal notranslate"><span class="pre">input_directory</span></code> as the directory were you generated the input files for
the city you want to simulate.  For more details on the other parameters
(especially the BETA parameters) see the <a class="reference internal" href="parameter.html"><span class="doc">parameter description</span></a>.</p>
<p>You can now run the program after providing the parameters at the command line
in the usual way.  Options that you do not specify will be set to their default
values as described in the output of the command <code class="docutils literal notranslate"><span class="pre">./drive_simulator</span> <span class="pre">-h</span></code> you ran
above.  Note that the INTERVENTION parameter must be a positive integer.</p>
<p>The output of the program will be generated in the <code class="docutils literal notranslate"><span class="pre">output_directory</span></code> that you
provide.  It consists of various CSV files (with human readable names)
containing time series data of various observables in the model.</p>
</div>
<div class="section" id="method-1-using-the-provided-shell-scripts">
<h3>Method 1: Using the provided shell scripts<a class="headerlink" href="#method-1-using-the-provided-shell-scripts" title="Permalink to this headline">¶</a></h3>
<p>You can also run the code for several interventions in one go using the driver
scripts provided here.  Or example, the driver script with default parameters
for Mumbai is called <code class="docutils literal notranslate"><span class="pre">drive_simulator_mum.sh</span></code>.  To run the code in this method,
you will have to edit the driver script (say <code class="docutils literal notranslate"><span class="pre">drive_simulator_mum.sh</span></code>) where you
can specify:</p>
<ol class="simple">
<li><p>The input parameters.</p></li>
<li><p>The directory where the output will be generated (The <code class="docutils literal notranslate"><span class="pre">output_directory_base</span></code>
parameter in the file).  This option can also be passed to the script from
the command line as shown below.</p></li>
<li><p>The directory in which the input files reside. (The <code class="docutils literal notranslate"><span class="pre">input_directory</span></code>
parameter in the file.)  This option can also be passed to the script from
the command line as shown below.</p></li>
</ol>
<p>Once you have fixed the parameters, you can run the script as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bash drive_simulator_temp.sh <span class="o">[</span>-i input_directory<span class="o">]</span> <span class="o">[</span>-o output_directory_base<span class="o">]</span>
</pre></div>
</div>
<p>in the <code class="docutils literal notranslate"><span class="pre">cpp-simulator</span></code> directory.  If everything works, it will end
with a message indicating success after a little while (~25s per
intervention on my computer with 1,00,000 agents).</p>
<p>The main simulator executable is still <code class="docutils literal notranslate"><span class="pre">drive_simulator</span></code>.</p>
<div class="section" id="viewing-the-output">
<h4>Viewing the output<a class="headerlink" href="#viewing-the-output" title="Permalink to this headline">¶</a></h4>
<p>The binary <code class="docutils literal notranslate"><span class="pre">drive_simulator</span></code> generates output as a set of csv files with information during each timestep. It also generates a <code class="docutils literal notranslate"><span class="pre">gnuplot</span></code> script file called <code class="docutils literal notranslate"><span class="pre">gnuplot_script.gnuplot</span></code>. If you have <code class="docutils literal notranslate"><span class="pre">gnuplot</span></code> installed, you may go to the folder and run <code class="docutils literal notranslate"><span class="pre">gnuplot</span> <span class="pre">gnuplot_script.gnuplot</span></code> and it will generate some prepecified plots that you can also view on using your favorite browser to open the <code class="docutils literal notranslate"><span class="pre">plots.html</span></code> files in the output directories.</p>
<ul class="simple">
<li><p>There will be one output directory per intervention (inside the directory you specified), containing the plots just for that intervention.</p></li>
<li><p>In addition, in the top level directory (the one you specified) with plots which plot the observable variables for all the interventions on the same plot.</p></li>
</ul>
<p>The per intervention directories also have the raw CSV files from
which the plots are generated.</p>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="parameter.html" class="btn btn-neutral float-right" title="Simulator parameters" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../instantiation/create_synthetic_city.html" class="btn btn-neutral float-left" title="Generating synthetic city" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, IISc - TIFR CoVID-19 Modelling Team

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>